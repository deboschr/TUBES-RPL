<!DOCTYPE html>
<html>

<head>
    <title>Berita Acara Pembimbingan Skripsi</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h1 {
            text-align: center;
        }

        /* Style untuk form input */
        input[type="text"],
        input[type="number"],
        input[type="date"],
        button {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        /* Style untuk tanda tangan */
        .container {
            display: flex;
            flex-wrap: wrap;
        }

        .column {
            flex: 1 1 40%;
            margin: 5px;
            text-align: center;
        }

        canvas {
            border: 1px solid #000;
        }

        /* Style untuk tabel kriteria penilaian */
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid #000;
            padding: 8px;
            text-align: left;
        }
    </style>
</head>

<body>
    <h1>Berita Acara Pembimbingan Skripsi</h1>
    <h3>Nama Mahasiswa:</h3>
    <input type="text" id="nama">
    <h3>NPM:</h3>
    <input type="text" id="npm">
    <h3>Dosen Pembimbing:</h3>
    <input type="text" id="pembimbing">
    <h3>Dosen Penguji:</h3>
    <input type="text" id="penguji">
    <h2>Kriteria Penilaian</h2>
    <table id="tabelKriteria">
        <tr>
            <th>No.</th>
            <th>Pembimbing/Penguji</th>
            <th>Nilai</th>
            <th>Bobot (%)</th>
            <th>Nilai Akhir</th>
        </tr>
        <!-- Baris 1 -->
        <tr>
            <td>1</td>
            <td>
                <input type="text" class="pembimbing_penguji" size="20">
            </td>
            <td>
                <input type="number" class="nilai" size="5">
            </td>
            <td>
                <input type="number" class="bobot" size="5">
            </td>
            <td>
                <span class="nilai_akhir"></span>
            </td>
        </tr>
        <!-- Baris 2 -->
        <tr>
            <td>2</td>
            <td>
                <input type="text" class="pembimbing_penguji" size="20">
            </td>
            <td>
                <input type="number" class="nilai" size="5">
            </td>
            <td>
                <input type="number" class="bobot" size="5">
            </td>
            <td>
                <span class="nilai_akhir"></span>
            </td>
        </tr>
        <!-- Baris 3 -->
        <tr>
            <td>3</td>
            <td>
                <input type="text" class="pembimbing_penguji" size="20">
            </td>
            <td>
                <input type="number" class="nilai" size="5">
            </td>
            <td>
                <input type="number" class="bobot" size="5">
            </td>
            <td>
                <span class="nilai_akhir"></span>
            </td>
        </tr>
        <!-- Baris 4 -->
        <tr>
            <td>4</td>
            <td>
                <input type="text" class="pembimbing_penguji" size="20">
            </td>
            <td>
                <input type="number" class="nilai" size="5">
            </td>
            <td>
                <input type="number" class="bobot" size="5">
            </td>
            <td>
                <span class="nilai_akhir"></span>
            </td>
        </tr>
        <!-- Total -->
        <tr>
            <td colspan="4">Total</td>
            <td>
                <span id="total_nilai_akhir"></span>
            </td>
        </tr>
    </table>
    <h3>Tanggal Ditetapkan:</h3>
    <input type="date" id="tanggal">
    <!-- Tanda Tangan -->
    <div class="container">
        <div class="column">
            <p>
                Dosen Penguji 1
            </p>
            <canvas id="signatureCanvas1" width="200" height="100"></canvas>
        </div>
        <div class="column">
            <p>
                Dosen Penguji 2
            </p>
            <canvas id="signatureCanvas2" width="200" height="100"></canvas>
        </div>
        <div class="column">
            <p>
                Dosen Pembimbing
            </p>
            <canvas id="signatureCanvas3" width="200" height="100"></canvas>
        </div>
        <div class="column">
            <p>
                Kordinator Skripsi
            </p>
            <canvas id="signatureCanvas4" width="200" height="100"></canvas>
        </div>
        <div class="column">
            <p>
                Mahasiswa
            </p>
            <canvas id="signatureCanvas5" width="200" height="100"></canvas>
        </div>
    </div>
    <button onclick="cetakBAP()">Cetak Dokumen</button>
    <script>
        function cetakBAP() {
            var nama = document.getElementById('nama').value;
            var npm = document.getElementById('npm').value;
            var pembimbing = document.getElementById('pembimbing').value;
            var penguji = document.getElementById('penguji').value;
            var tanggalDitetapkan = document.getElementById('tanggal').value;
            var tabelKriteria = document.getElementById('tabelKriteria');
            var rows = tabelKriteria.getElementsByTagName('tr');
            var kriteria = [];
            var totalNilaiAkhir = 0;
            for (var i = 1; i < rows.length - 1; i++) {
                var currentRow = rows[i];
                var cells = currentRow.getElementsByTagName('td');
                var nilai = parseFloat(cells[2].querySelector('.nilai').value);
                var bobot = parseFloat(cells[3].querySelector('.bobot').value);
                var nilaiAkhir = (nilai * (bobot / 100)).toFixed(2);
                cells[4].querySelector('.nilai_akhir').innerText = nilaiAkhir;
                totalNilaiAkhir += parseFloat(nilaiAkhir);
                var kriteriaData = {
                    no: cells[0].innerText,
                    pembimbingPenguji: cells[1].querySelector('.pembimbing_penguji').value,
                    nilai: nilai,
                    bobot: bobot,
                    nilaiAkhir: nilaiAkhir
                };
                kriteria.push(kriteriaData);
            }
            document.getElementById('total_nilai_akhir').innerText = totalNilaiAkhir.toFixed(2);
            var printContent = `
                <h1>Berita Acara Pembimbingan Skripsi</h1>
                <br>
                <br>
                <h3>Nama Mahasiswa:</h3>
                <p>${nama}</p>
                <h3>NPM:</h3>
                <p>${npm}</p>
                <h3>Dosen Pembimbing:</h3>
                <p>${pembimbing}</p>
                <h3>Dosen Penguji:</h3>
                <p>${penguji}</p>
                <h2>Kriteria Penilaian</h2>
                <table>
                    <tr>
                        <th>No.</th>
                        <th>Pembimbing/Penguji</th>
                        <th>Nilai</th>
                        <th>Bobot (%)</th>
                        <th>Nilai Akhir</th>
                    </tr>
            `;
            kriteria.forEach(function (kriteriaData) {
                printContent += `
                    <tr>
                        <td>${kriteriaData.no}</td>
                        <td>${kriteriaData.pembimbingPenguji}</td>
                        <td>${kriteriaData.nilai}</td>
                        <td>${kriteriaData.bobot}</td>
                        <td>${kriteriaData.nilaiAkhir}</td>
                    </tr>
                `;
            });
            printContent += `
    <tr>
        <td colspan="4">Total</td>
        <td>${totalNilaiAkhir.toFixed(2)}</td>
    </tr>
    </table>
    <h3>Tanggal Ditetapkan:</h3>
        <p>${tanggalDitetapkan}</p>
    <h3>Tanda Tangan:</h3>
`;
            var signatures = document.getElementsByClassName('container')[0].getElementsByTagName('canvas');
            var signatureImages = [];
            for (var i = 0; i < signatures.length; i++) {
                var canvas = signatures[i];
                var ctx = canvas.getContext('2d');
                // Tambahkan border pada canvas sebelum mengambil gambar
                ctx.strokeStyle = '#000'; // Warna border
                ctx.strokeRect(0, 0, canvas.width, canvas.height);
                var imgData = canvas.toDataURL();
                signatureImages.push(imgData);
            }
            // Tambahkan gambar-gambar tanda tangan ke printContent dengan label nama yang berada di tengah kotak
            var signatureLabels = ["Dosen Penguji 1", "Dosen Penguji 2", "Dosen Pembimbing", "Koordinator Skripsi", "Mahasiswa"];
            printContent += '<div style="display: flex; flex-wrap: wrap;">'; // Mulai kontainer untuk tanda tangan horizontal
            signatureImages.forEach(function (imgData, index) {
                printContent += `<div style="flex: 0 0 20%; margin: 10px 0; display: flex; flex-direction: column; justify-content: center; align-items: center;">
        <img src="${imgData}" style="border: 1px solid #000; max-width: 100%;">
        <p style="text-align: center; margin: 5px 0;">${signatureLabels[index]}</p>
    </div>`;
            });
            printContent += '</div>'; // Selesai kontainer untuk tanda tangan horizontal
            var printWindow = window.open('', '_blank');
            printWindow.document.open();
            printWindow.document.write(`
        <html>
        <head>
            <title>BAP Skripsi - ${nama}</title>
            <style>
                /* Styles untuk cetak */
                @media print {
    table {
        /* Gaya untuk tabel saat dicetak */
        border-collapse: collapse;
        width: 100%;
    }
    th, td {
        /* Gaya untuk sel-sel dalam tabel saat dicetak */
        border: 1px solid #000;
        padding: 8px;
        text-align: left;
    }
    h1 {
        text-align: center;
    }
    h2 {
        text-align: center;
    }
    /* Gaya lainnya untuk cetak */
}
                /* Styles lainnya */
            </style>
        </head>
        <body>${printContent}</body>
        </html>
    `);
            printWindow.document.close();
            // Lakukan pencetakan setelah konten dimuat
            printWindow.onload = function () {
                printWindow.print(); // Memicu pencetakan
                printWindow.onafterprint = function () {
                    printWindow.close(); // Tutup jendela setelah mencetak
                };
            };
        }
    </script>
</body>

</html>